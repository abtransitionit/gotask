# toknow: by default, multiple jobs inside the same xx.yaml file run concurrently, unless explicitly dependencies is defined.
# Notes: 
#  - No build is needed and no artifact is generated because this is a library of code
name: Main branch CI

on:
  # trigger when push on branch
  push:
    branches:
      - main

jobs:
  install-go:
     uses: abtransitionit/cicd-go/.github/workflows/go-install.yaml@main
     with:
        go-version: '1.24'

  checkout-code:
    needs: install-go
    uses: abtransitionit/cicd-go/.github/workflows/code-checkout.yaml@main

  check-code:
    needs: checkout-code
    uses: abtransitionit/cicd-go/.github/workflows/code-check.yaml@main

  install-code-dependencies:
    needs: check-code
    uses: abtransitionit/cicd-go/.github/workflows/code-dep.yaml@main

  test-code:
    needs: install-code-dependencies
    uses: abtransitionit/cicd-go/.github/workflows/code-test.yaml@main
